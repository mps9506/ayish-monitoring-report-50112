---
title: "Ayish Bayou Water Quality Monitoring Report"
author:
  - Michael Schramm ^1^, Lucas Gregory ^2^, Jeremiah Poling ^3^, Emylea Cole ^3^
  - ^1^ Texas Water Resources Institute, Texas A\&M AgriLife Research
  - ^2^ Texas Water Resources Institute, Texas A\&M AgriLife Extension Service
  - ^3^ Angelina \& Neches River Authority 
date: "August 31, 2025"
output: 
  officedown::rdocx_document:
    reference_docx: format.docx
    plots:
      style: Normal
      align: center
      fig.lp: 'fig:'
      topcaption: false
      caption:
        style: Image Caption
        pre: 'Figure '
        sep: '. '
        tnd: 0
        tns: '-'
        fp_text: !expr officer::fp_text_lite(bold = FALSE)
    tables:
      style: Table
      layout: autofit
      width: 1.0
      topcaption: true
      tab.lp: 'tab:'
      caption:
        style: Table Caption
        pre: 'Table '
        sep: '. '
        tnd: 0
        tns: '-'
        fp_text: !expr officer::fp_text_lite(bold = FALSE)
bibliography: bibliography.bib
csl: council-of-science-editors-author-date.csl
---

```{r setup, include=FALSE}
## load libraries
library(officer)
library(officedown)
library(flextable)
library(ragg)

## this sets our default code chunk options
knitr::opts_chunk$set(dev = "ragg_png",
                      echo = FALSE,
                      ## figure chunk options
                      fig.cap = TRUE,
                      fig.width = 6)

## flextable defaults

flextable::set_flextable_defaults(digits = 2)


library(readxl)
library(dplyr)
library(tidyr)
library(janitor)
library(ggplot2)
library(patchwork)




df <- read_excel("../data/data.xlsx", col_types = c("text",
    "text", "text", "text", "date", "text",
    "text", "text", "text", "text", "text",
    "text", "text", "text", "text", "text",
    "text", "text", "text", "text", "text",
    "text", "text", "text", "text", "text",
    "text", "text", "text"))

df <- df |> 
  #filter(tag != "K004989") |> 
  pivot_longer(cols = "TEMPERATURE, WATER (DEGREES CENTIGRADE)":"SULFATE (MG/L AS SO4)") |> 
  mutate(censor = case_when(
    stringr::str_starts(value, "<") ~ "<",
    stringr::str_starts(value, ">") ~ ">",
    .default = NA
  )) |> 
  mutate(value = stringr::str_remove(value, "<")) |> 
  mutate(value = stringr::str_remove(value, ">")) |> 
  mutate(value = as.numeric(value))

```


Texas Water Resources Institute`r run_linebreak()`
Texas A&M AgriLife`r run_linebreak()`
College Station, TX




Report developed for and funded by the Texas Commission on Environmental Quality.


```{r}
## leave in, starts new word document section
## after table of abbreviations
block_section(prop_section(type = "nextPage"))
```

::: {custom-style="Unnumbered Heading 1"}

Table of Contents

:::

<!---BLOCK_TOC--->

::: {custom-style="Unnumbered Heading 1"}

Table of Figures

:::

<!---BLOCK_TOC{seq_id: 'fig'}--->

::: {custom-style="Unnumbered Heading 1"}

Table of Tables

:::

<!---BLOCK_TOC{seq_id: 'tab'}--->

::: {custom-style="Unnumbered Heading 1"}

Abbreviations

:::


```{r}
## leave in, ends word document section
## after table of abbreviations
block_section(prop_section(type = "nextPage"))
```


# Introduction

Work under this data collection project included water quality data collection 
in Ayish Bayou and its tributaries for future watershed planning efforts.
Water quality data on the Ayish Bayou and its tributaries was collected to 
provide improved temporal and spatial data resolution for future watershed 
planning and assessment purposes. 
Water quality monitoring was conducted monthly at monitoring stations 15361, 
15365, 21431, 22399 on TCEQ Segment 0610A (Ayish Bayou), 15358 on 0610K 
(Sandy Creek), 15359 on 0610I (Chiamon Creek), 15362 on 0610G (Caney Creek), 
and 15363 on 0610M (Venado Creek). The 2022 Texas Integrated Report on
Water Quality provides the following segment descriptions:

- **0610A Ayish Bayou**: Perennial stream from the headwaters of Sam Rayburn 
Reservoir to the dam impounding Bland Lake approximately 0.1km upstream of FM 
1279 near the City of San Augustine.

- **0610K Sandy Creek in San Augustine County**: From the confluence with Ayish 
Bayou (0610A) upstream to headwaters in San Augustine County.

- **0610I Chiamon Creek**: From the confluence with Ayish Bayou (0610A) in San 
Augustine County upstream to headwaters in Sabine County.

- **0610G Caney Creek in San Augustine County**: From the confluence with Ayish 
Bayou (0610A) in San Augustine County upstream to headwaters.

- **0610M Venado Creek**: From the confluence with Ayish Bayou (0610A) upstream 
to headwaters in San Augustine County.

Each water body is considered perennial with a "high" Aquatic Life Use designation.
Ayish Bayou (0610A) has been identified as impaired in the *2022 Texas 
Integrated Report of Water Quality* for exceeding the primary 
recreation use I criterion due to elevated *Escherichia coli* (*E. coli*) 
and was first listed impaired in 2000.
Focus of the monitoring project was for bacterial impairments, but other
water quality parameters were collected to provide further information for 
planning efforts.
Under this project sampling included collection of basic field parameters,
conventional, and bacteriological parameters. Sampling occurred monthly at all 
sites; however, sites 15361 and 21431 on Ayish Bayou were sampled quarterly under
the previously planned quarterly Clean Rivers Program monitoring efforts.
Quarterly samples are not included in this report.
All work was conducted under an approved Quality Assurance Project Plan.


<!-- Insert map of sample sites -->
<!-- Generate Summary of trips and dates -->

# Data Summary

[Table \@ref(tab:summary)](#tab:summary) provides a a summary of the number of
samples (n), minimum, maximum, standard deviation, and measure of central tendency
for conventional, bacteria, and certain field parameters by site. 
Geometric means are reported for *E. coli* and means are reported for all 
other parameters. 
Full data records for field, conventional, and bacteriological from 
all sites are listed by segment in Appendix A ([Table \@ref(tab:ayish)](#tab:ayish),
[Table \@ref(tab:caney)](#tab:caney), [Table \@ref(tab:chiamon)](#tab:chiamon),
[Table \@ref(tab:venado)](#tab:venado)).


<!---BLOCK_LANDSCAPE_START--->


```{r message=FALSE, warning=FALSE, tab.cap='Summary', tab.id='summary'}
params <- df |> 
  distinct(name) |> 
  filter(name != "E_COLI, COLILERT, IDEXX, HOLDING TIME") |>
  filter(name != "DEPTH OF BOTTOM OF WATER BODY AT SAMPLE SITE MET") |> 
  pull(name)
## can we highlight cells that exceed critria?
df |> 
  filter(name %in% params) |> 
  group_by(`Station Id`, `Station_Desc`, name) |> 
  summarise(n = n(),
            min = min(value),
            max = max(value),
            "Standard deviation" = round(sd(value),2),
            mean = round(mean(value),2),
            geomean = round(EnvStats::geoMean(value), 2)) |> 
  mutate(center = case_when(
    name == "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML" ~ geomean,
    .default = mean)) |> 
  ungroup() |> 
  mutate("SWQM Site" = paste0(`Station Id`, " ", Station_Desc)) |> 
  select(-c("mean", "geomean", "Station Id", "Station_Desc")) |> 
  group_by(`SWQM Site`) |> 
  flextable::as_grouped_data(groups = c("SWQM Site")) |> 
  flextable::as_flextable() |> 
  bold(j = 1, i = ~ !is.na(`SWQM Site`), bold = TRUE, part = "body") |> 
  flextable::autofit() |>
  style(j = 1, i = ~ !is.na(`SWQM Site`),
        pr_p = fp_par(padding.right = 1.5)
        ) |> 
  ## this is a decimal tab
  #tab_settings(j = 1, i = ~ !is.na(name), value = fp_tabs(fp_tab(pos = 0.5, style = "decimal")), part = "body") |> 
  flextable::colformat_num(drop0trailing = TRUE) |> 
  flextable::set_header_labels(name = "Parameter",
                               min = "Minimum",
                               max = "Maximum",
                               center = "Center") |> 
  footnote(i = 1, j = 6,
           value = as_paragraph(as_chunk("Center refers to the geometric mean for "), 
                                as_chunk("E. coli" , props = fp_text_default(italic = TRUE)),
                                as_chunk(" and the mean for all other parameters.")),
           ref_symbols = "a", part = "header")
```

<!---BLOCK_LANDSCAPE_STOP--->

<!-- Water quality monitoring was conducted monthly at monitoring stations 15361,  -->
<!-- 15365, 21431, 22399 on TCEQ Segment 0610A (Ayish Bayou), 15358 on 0610K  -->
<!-- (Sandy Creek), 15359 on 0610I (Chiamon Creek), 15362 on 0610G (Caney Creek),  -->
<!-- and 15363 on 0610M (Venado Creek). -->


The distribution of and time series of dissolved oxygen, *E. coli*, nitrate,
nitrite, ammonia, Kjeldahl nitrogen, and total phosphorus concentrations are shown 
in Figures \@ref(fig:do) - \@ref(fig:tp).
The majority of dissolved oxygen concentrations were above the minimum and grab 
screening level standards (Figure \@ref(fig:do)). However, stations 15359 (Chiamon Creek) and 15362 
(Caney Creek) had high proportions of measurements below either the grab 
screening level (5 mg/L) or minimum dissolved oxygen criteria (3 mg/L) for 
high aquatic life use. All stations had *E. coli* average geometric mean 
concentrations above the primary recreation I criteria of 126 MPN/100 mL 
(Figure \@ref(fig:ecoli)). Nitrate nitrogen and total phosphorus were well below 
the screening level across all stations (Figures \@ref(fig:nitrate); \@ref(fig:tp)).
Nearly all of the nitrite-nitrogen and ammonia samples were below laboratory
limits of quantification (Figures \@ref(fig:nitrite); \@ref(fig:ammonia)).



```{r do, fig.cap="Grab Dissolved Oxygen samples by (A) station and by (B) date. Dissolved Oxygen grab minimum and screening level criterion are indicated by the solid and dashed lines.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[3]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value), width = 0.1, height = 0, alpha = 0.5, color = "dodgerblue") +
  geom_hline(aes(yintercept = 5, linetype = "Dissolved Oxygen Grab Screening Level")) +
  geom_hline(aes(yintercept = 3, linetype = "Dissolved Oxygen Grab Minimum")) +
  scale_linetype_manual("", values= c(1,2)) +
  labs(y = params[[3]], x = "SWQM Station ID") +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[3]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`), alpha = 0.5, color = "dodgerblue") +
  #geom_line(aes(x = Date, y = value, group = `Station Id`), alpha = 0.5) +
  geom_hline(aes(yintercept = 5, linetype = "Dissolved Oxygen Grab Screening Level")) +
  geom_hline(aes(yintercept = 3, linetype = "Dissolved Oxygen Grab Minimum")) +
  facet_wrap(vars(`Station Id`)) +
  scale_linetype_manual("", values= c(1,2)) +
  labs(y = params[[3]], x = "Date") +
  theme_bw()

p1 / p2 + plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```






```{r ecoli, fig.cap="Grab E. coli samples by (A) station and by (B) date. Seven-year geometric mean and single sample criterion are indicated by the solid and dashed lines. Censored values are greater than the laboratory reported level of quantification.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[6]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  geom_hline(aes(yintercept = 126, linetype = "Geometric Mean Criterion")) +
  geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  scale_y_log10() +
  scale_color_grey("", labels = c("Right-censored (>)", "Lab-reported value"), na.value = "dodgerblue") +
  scale_linetype_manual("", values= c(1,2)) +
  labs(y = params[[6]], x = "SWQM Station ID") +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[6]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  geom_hline(aes(yintercept = 126, linetype = "Geometric Mean Criterion")) +
  geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  scale_y_log10() +
  scale_color_grey("", labels = c("Right-censored (>)", "Lab-reported value"), na.value = "dodgerblue") +
  scale_linetype_manual("", values= c(1,2)) +
  labs(y = params[[6]], x = "Date") +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```



```{r nitrate, fig.cap="Grab Nitrate-Nitrogen samples by (A) station and by (B) date. The 1.95 mg/L screening level is indicated by the dashed line. Censored values are less than the laboratory level of quantificaton.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[8]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #scale_y_log10() +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[8]], x = "SWQM Station ID") +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[8]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[8]], x = "Date") +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```

```{r nitrite, fig.cap="Grab Nitrite-Nitrogen samples by (A) station and by (B) date. Censored values are less than the laboratory level of quantificaton.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[9]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  #geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #scale_y_log10() +
  #scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[9]], x = "SWQM Station ID") +
  coord_cartesian(ylim = c(0,0.1)) +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[9]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  #geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  #scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[9]], x = "Date") +
  coord_cartesian(ylim = c(0,0.1)) +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```


```{r ammonia, fig.cap="Grab Nitrogen-Ammonia samples by (A) station and by (B) date. Censored values are less than the laboratory level of quantificaton.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[10]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  geom_hline(aes(yintercept = 0.35, linetype = "Screening level (0.33 mg/L)")) +
  #scale_y_log10() +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[10]], x = "SWQM Station ID") +
  coord_cartesian(ylim = c(0,0.35)) +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[10]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  geom_hline(aes(yintercept = 0.33, linetype = "Screening level (0.33 mg/L)")) +
  #geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[10]], x = "Date") +
  coord_cartesian(ylim = c(0,0.35)) +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```


```{r kjeldahl, fig.cap="Grab Nitrogen-Kjeldahl samples by (A) station and by (B) date. Censored values are less than the laboratory level of quantificaton.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[11]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  #geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #scale_y_log10() +
  #scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[11]], x = "SWQM Station ID") +
  coord_cartesian(ylim = c(0,1.5)) +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[11]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  #geom_hline(aes(yintercept = 1.95, linetype = "Screening level (1.95 mg/L)")) +
  #geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  #scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[11]], x = "Date") +
  coord_cartesian(ylim = c(0,1.5)) +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```


```{r tp, fig.cap="Grab Total Phosphorus samples by (A) station and by (B) date. The dotted line indicates the 0.69 mg/L screening level. Censored values are less than the laboratory level of quantificaton.", fig.alt="Alternative text for screen readers", fig.width=6, fig.height=8, fig.dpi=200}
p1 <- df |> 
  filter(name %in% params[[12]]) |> 
  ggplot() +
  geom_boxplot(aes(x = `Station Id`, y = value), outliers = FALSE) +
  geom_jitter(aes(x = `Station Id`, y = value, color = censor), width = 0.1, height = 0, alpha = 0.5) +
  geom_hline(aes(yintercept = 1.95, linetype = "Screening level (0.69 mg/L)")) +
  #scale_y_log10() +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[12]], x = "SWQM Station ID") +
  #coord_cartesian(ylim = c(0,1.5)) +
  theme_bw()
  

p2 <- df |> 
  filter(name %in% params[[12]]) |> 
  ggplot() +
  geom_point(aes(x = Date, y = value, group = `Station Id`, color = censor), alpha = 0.5) +
  geom_hline(aes(yintercept = 1.95, linetype = "Screening level (0.69 mg/L)")) +
  #geom_hline(aes(yintercept = 399, linetype = "Single Sample Criterion")) +
  facet_wrap(vars(`Station Id`)) +
  scale_linetype_manual("", values= c(2)) +
  scale_color_grey("", labels = c("Left-censored (<)", "Lab-reported value"), na.value = "dodgerblue") +
  labs(y = params[[12]], x = "Date") +
  #coord_cartesian(ylim = c(0,1.5)) +
  theme_bw()

p1 / p2 + 
  plot_annotation(tag_levels = "A") + 
  plot_layout(axis_titles = "collect_y", guides = "collect") &
  theme(legend.position = "bottom")
  
```


```{r}

##3 need to remove <, and sub estimate when available
df |> 
  distinct(tag, `Station Id`, `FLOW  STREAM, INSTANTANEOUS (CUBIC FEET PER SEC)`, Date) |>
  mutate(Flow = as.numeric(`FLOW  STREAM, INSTANTANEOUS (CUBIC FEET PER SEC)`)) |> 
  ggplot() + 
  geom_histogram(aes(Flow), bins = 50) +
  scale_x_log10(labels = scales::label_comma()) +
  theme_bw()
```


```{r}
## leave in, ends word document section
block_section(prop_section(type = "nextPage"))
```

# Bibliography {-}

<div id="refs"></div>

```{r}
## leave in, ends word document section

block_section(prop_section(type = "nextPage"))
```



# Appendix A {-}

```{r}
## leave in, ends word document section

block_section(prop_section(type = "nextPage"))
```


## Ayish Bayou 0610A Data

```{r}
## leave in, ends word document section

block_section(prop_section(type = "nextPage"))
```

<!---BLOCK_LANDSCAPE_START--->


```{r ayish, tab.cap="Data records for Ayish Bayou Segment 0610A.", tab.id="ayish"}
df |> 
  filter(`Station Id` %in% c("22399", "15361", "21431", "15365")) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value, censor) |> 
  mutate(value = case_when(
    !is.na(censor) ~ stringr::str_c(censor, value),
    is.na(censor) ~ paste0(value))
    ) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value) |> 
  filter(name %in% c("NITRITE NITROGEN, TOTAL (MG/L AS N)",
                     "NITROGEN, AMMONIA, TOTAL (MG/L AS N)",
                     "NITROGEN, KJELDAHL, TOTAL (MG/L AS N)",
                     "RESIDUE, TOTAL NONFILTRABLE (MG/L)",
                     "SULFATE (MG/L AS SO4)",
                     "OXYGEN, DISSOLVED (MG/L)",
                     "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML",
                     "CHLORIDE (MG/L AS CL)",
                     "NITRATE NITROGEN, TOTAL (MG/L AS N)",
                     "PHOSPHORUS, TOTAL, WET METHOD (MG/L AS P)")) |> 
  pivot_wider(names_from = name,
              values_from = value) |> 
  mutate(Date = as.Date(Date)) |> 
  flextable::flextable() |> 
  flextable::fontsize(size = 8, part = "all") |> 
  flextable::bold(part = "header") |> 
  flextable::align(j = c(4:14), align = "right", part = "all") |> 
  flextable::set_header_labels(tag = "Tag ID",
                               `Station Id` = "SWQM Station",
                               Station_Desc = "Station Description",
                               `E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML` = "E. COLI, COLILERT, IDEXX METHOD (MPN/100ML)") |> 
  flextable::padding(padding = 1, part = "all")
```


<!---BLOCK_LANDSCAPE_STOP--->


##  Caney Creek 0610G Data

<!---BLOCK_LANDSCAPE_START--->

```{r caney, tab.cap="Data records for Caney Creek Segment 0610G.", tab.id="caney"}
df |> 
  filter(`Station Id` %in% c("15362")) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value, censor) |> 
  mutate(value = case_when(
    !is.na(censor) ~ stringr::str_c(censor, value),
    is.na(censor) ~ paste0(value))
    ) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value) |> 
  filter(name %in% c("NITRITE NITROGEN, TOTAL (MG/L AS N)",
                     "NITROGEN, AMMONIA, TOTAL (MG/L AS N)",
                     "NITROGEN, KJELDAHL, TOTAL (MG/L AS N)",
                     "RESIDUE, TOTAL NONFILTRABLE (MG/L)",
                     "SULFATE (MG/L AS SO4)",
                     "OXYGEN, DISSOLVED (MG/L)",
                     "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML",
                     "CHLORIDE (MG/L AS CL)",
                     "NITRATE NITROGEN, TOTAL (MG/L AS N)",
                     "PHOSPHORUS, TOTAL, WET METHOD (MG/L AS P)")) |> 
  pivot_wider(names_from = name,
              values_from = value) |> 
  mutate(Date = as.Date(Date)) |> 
  flextable::flextable() |> 
  flextable::fontsize(size = 8, part = "all") |> 
  flextable::bold(part = "header") |> 
  flextable::align(j = c(4:14), align = "right", part = "all") |> 
  flextable::set_header_labels(tag = "Tag ID",
                               `Station Id` = "SWQM Station",
                               Station_Desc = "Station Description",
                               `E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML` = "E. COLI, COLILERT, IDEXX METHOD (MPN/100ML)") |> 
  flextable::padding(padding = 1, part = "all")
```

<!---BLOCK_LANDSCAPE_STOP--->


## Chiamon Bayou 0610I Data

<!---BLOCK_LANDSCAPE_START--->

```{r chiamon, tab.cap="Data records for Chiamon Bayou Segment 0610I.", tab.id="chiamon"}
df |> 
  filter(`Station Id` %in% c("15359")) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value, censor) |> 
  mutate(value = case_when(
    !is.na(censor) ~ stringr::str_c(censor, value),
    is.na(censor) ~ paste0(value))
    ) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value) |> 
  filter(name %in% c("NITRITE NITROGEN, TOTAL (MG/L AS N)",
                     "NITROGEN, AMMONIA, TOTAL (MG/L AS N)",
                     "NITROGEN, KJELDAHL, TOTAL (MG/L AS N)",
                     "RESIDUE, TOTAL NONFILTRABLE (MG/L)",
                     "SULFATE (MG/L AS SO4)",
                     "OXYGEN, DISSOLVED (MG/L)",
                     "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML",
                     "CHLORIDE (MG/L AS CL)",
                     "NITRATE NITROGEN, TOTAL (MG/L AS N)",
                     "PHOSPHORUS, TOTAL, WET METHOD (MG/L AS P)")) |> 
  pivot_wider(names_from = name,
              values_from = value) |> 
  mutate(Date = as.Date(Date)) |> 
  flextable::flextable() |> 
  flextable::fontsize(size = 8, part = "all") |> 
  flextable::bold(part = "header") |> 
  flextable::align(j = c(4:14), align = "right", part = "all") |> 
  flextable::set_header_labels(tag = "Tag ID",
                               `Station Id` = "SWQM Station",
                               Station_Desc = "Station Description",
                               `E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML` = "E. COLI, COLILERT, IDEXX METHOD (MPN/100ML)") |> 
  flextable::padding(padding = 1, part = "all")
```

<!---BLOCK_LANDSCAPE_STOP--->

## Sandy Creek 0610K Data

<!---BLOCK_LANDSCAPE_START--->

```{r sandy, tab.cap="Data records for Sandy Creek Segment 0610K.", tab.id="sandy"}
df |> 
  filter(`Station Id` %in% c("15358")) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value, censor) |> 
  mutate(value = case_when(
    !is.na(censor) ~ stringr::str_c(censor, value),
    is.na(censor) ~ paste0(value))
    ) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value) |> 
  filter(name %in% c("NITRITE NITROGEN, TOTAL (MG/L AS N)",
                     "NITROGEN, AMMONIA, TOTAL (MG/L AS N)",
                     "NITROGEN, KJELDAHL, TOTAL (MG/L AS N)",
                     "RESIDUE, TOTAL NONFILTRABLE (MG/L)",
                     "SULFATE (MG/L AS SO4)",
                     "OXYGEN, DISSOLVED (MG/L)",
                     "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML",
                     "CHLORIDE (MG/L AS CL)",
                     "NITRATE NITROGEN, TOTAL (MG/L AS N)",
                     "PHOSPHORUS, TOTAL, WET METHOD (MG/L AS P)")) |> 
  pivot_wider(names_from = name,
              values_from = value) |> 
  mutate(Date = as.Date(Date)) |> 
  flextable::flextable() |> 
  flextable::fontsize(size = 8, part = "all") |> 
  flextable::bold(part = "header") |> 
  flextable::align(j = c(4:14), align = "right", part = "all") |> 
  flextable::set_header_labels(tag = "Tag ID",
                               `Station Id` = "SWQM Station",
                               Station_Desc = "Station Description",
                               `E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML` = "E. COLI, COLILERT, IDEXX METHOD (MPN/100ML)") |> 
  flextable::padding(padding = 1, part = "all")
```

<!---BLOCK_LANDSCAPE_STOP--->

## Venado Creek 0610M Data

<!---BLOCK_LANDSCAPE_START--->

```{r venado, tab.cap="Data records for Venado Creek Segment 0610M.", tab.id="venado"}
df |> 
  filter(`Station Id` %in% c("15363")) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value, censor) |> 
  mutate(value = case_when(
    !is.na(censor) ~ stringr::str_c(censor, value),
    is.na(censor) ~ paste0(value))
    ) |> 
  select(tag, `Station Id`, Station_Desc, Date, name, value) |> 
  filter(name %in% c("NITRITE NITROGEN, TOTAL (MG/L AS N)",
                     "NITROGEN, AMMONIA, TOTAL (MG/L AS N)",
                     "NITROGEN, KJELDAHL, TOTAL (MG/L AS N)",
                     "RESIDUE, TOTAL NONFILTRABLE (MG/L)",
                     "SULFATE (MG/L AS SO4)",
                     "OXYGEN, DISSOLVED (MG/L)",
                     "E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML",
                     "CHLORIDE (MG/L AS CL)",
                     "NITRATE NITROGEN, TOTAL (MG/L AS N)",
                     "PHOSPHORUS, TOTAL, WET METHOD (MG/L AS P)")) |> 
  pivot_wider(names_from = name,
              values_from = value) |> 
  mutate(Date = as.Date(Date)) |> 
  flextable::flextable() |> 
  flextable::fontsize(size = 8, part = "all") |> 
  flextable::bold(part = "header") |> 
  flextable::align(j = c(4:14), align = "right", part = "all") |> 
  flextable::set_header_labels(tag = "Tag ID",
                               `Station Id` = "SWQM Station",
                               Station_Desc = "Station Description",
                               `E_ COLI, COLILERT, IDEXX METHOD, MPN/100ML` = "E. COLI, COLILERT, IDEXX METHOD (MPN/100ML)") |> 
  flextable::padding(padding = 1, part = "all")
```

<!---BLOCK_LANDSCAPE_STOP--->
